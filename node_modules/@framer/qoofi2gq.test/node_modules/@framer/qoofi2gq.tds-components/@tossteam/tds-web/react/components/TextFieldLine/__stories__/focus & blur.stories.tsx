import { action } from '@storybook/addon-actions';
import { storiesOf } from '@storybook/react';
import * as React from 'react';

import { Form, TextFieldLine } from 'src/react';

import Readme from '../README.md';

storiesOf('TextFieldLine', module)
  .addParameters({ readme: { sidebar: Readme } })
  .add('focus & blur', () => {
    function TextFieldLineExample() {
      const backRef = React.useRef<HTMLInputElement>(null);

      const [ssnFront, setSsnFront] = React.useState<string>('');
      const [ssnBack, setSsnBack] = React.useState<string>('');

      function onChangeSsnFront(e: React.ChangeEvent<HTMLInputElement>) {
        const front = e.target.value;

        setSsnFront(e.target.value);
        action('onChange - TextFieldLine - 주민번호 앞자리')(...arguments);

        if (front.length === 6) {
          backRef.current!.focus();
        }
      }

      function onChangeSsnBack(e: React.ChangeEvent<HTMLInputElement>) {
        const back = e.target.value;

        setSsnBack(back);
        action('onChange - TextFieldLine - 주민번호 뒷자리')(...arguments);

        if (back.length === 7) {
          backRef.current!.blur();
        }
      }

      return (
        <Form inputComponent={TextFieldLine}>
          <Form.Group>
            <TextFieldLine
              maxLength={6}
              label="주민번호 앞자리"
              value={ssnFront}
              onChange={onChangeSsnFront}
            />
          </Form.Group>
          <Form.Group>
            <TextFieldLine
              ref={backRef}
              maxLength={7}
              label="주민번호 뒷자리"
              value={ssnBack}
              onChange={onChangeSsnBack}
            />
          </Form.Group>
        </Form>
      );
    }

    return <TextFieldLineExample />;
  });

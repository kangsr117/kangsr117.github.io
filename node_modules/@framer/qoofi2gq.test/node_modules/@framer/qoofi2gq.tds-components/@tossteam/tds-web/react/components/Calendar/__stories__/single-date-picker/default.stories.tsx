import { action } from "@storybook/addon-actions";
import { storiesOf } from "@storybook/react";
import { addDays, addMonths, subDays, subMonths } from "date-fns";
import * as React from "react";
import { useCallback, useState } from "react";
import { Button } from "src/react";
import SingleDatePicker from "../../SingleDatePicker";

storiesOf("Calendar.Single Date Picker (SDP)", module)
  .add("default", () => {
    return <DefaultExample />;
  })
  .add("pagination", () => {
    return <PaginationExample />;
  });

function DefaultExample() {
  const [date, setDate] = useState<Date | undefined>(new Date());
  const handleDateChange = useCallback((date: Date | undefined) => {
    action("onDateChange");
    setDate(date);
  }, []);
  return (
    <SingleDatePicker selectedDate={date} onDateChange={handleDateChange} />
  );
}

function PaginationExample() {
  const [month, setMonth] = useState(new Date());
  const [date, setDate] = useState<Date | undefined>(new Date());

  const incMonth = useCallback(() => {
    setMonth(addMonths(month, 1));
  }, [month]);

  const decMonth = useCallback(() => {
    setMonth(subMonths(month, 1));
  }, [month]);

  const incDay = useCallback(() => {
    if (date) {
      setDate(addDays(date, 1));
    }
  }, [date]);

  const decDay = useCallback(() => {
    if (date) {
      setDate(subDays(date, 1));
    }
  }, [date]);

  const handleDateChange = useCallback((date: Date | undefined) => {
    setDate(date);
    action("onDateChange");
  }, []);

  return (
    <div>
      <Button size="medium" onClick={decMonth}>
        -1 Month
      </Button>
      <Button size="medium" onClick={incMonth}>
        +1 Month
      </Button>
      <br />
      <Button size="medium" style="weak" onClick={decDay}>
        -1 Day
      </Button>
      <Button size="medium" style="weak" onClick={incDay}>
        +1 Day
      </Button>
      <SingleDatePicker
        onDateChange={handleDateChange}
        selectedDate={date}
        initialMonth={month}
        maxVisibleMonth={month}
      />
    </div>
  );
}

import { addPropertyControls, ControlType } from 'framer';
import * as React from 'react';
import { ComponentProps } from 'react';
import { Button as TDSButton } from '../@tossteam/tds-web/react/components/Button/Button';
import { default as TDSIcon } from '../@tossteam/tds-web/react/components/Icon/Icon';
import { default as TDSResult } from '../@tossteam/tds-web/react/components/Result/Result';
import Lottie from '../@tossteam/tds-web/react/storybook/Lottie';
import { TDSComponent } from '../src/components/TDSComponent';
import { useFilteringEventHandlersInInspector } from '../src/hooks/useFilteringEventHandlersInInspector';
import '../src/styles/tds-framer.css';
import { makeComponentDisplayName } from '../src/utils/makeDisplayName';
import {
  styleByControlLabel,
  StyleLabel as ButtonStyleLabel,
  styleLabels as buttonStyleLabels,
  typeByControlLabel,
  TypeLabel as ButtonTypeLabel,
  typeLabels as buttonTypeLabels,
} from './Button';

const figureTypeLables = ['ë¡œë ', 'ì•„ì´ì½˜', 'ì—†ìŒ'] as const;
const titleLabels = ['ìˆìŒ', 'ì—†ìŒ'] as const;
const descriptionLabels = ['ìˆìŒ', 'ì—†ìŒ'] as const;
const buttonLabels = ['ìˆìŒ', 'ì—†ìŒ'] as const;

type TDSResultProps = ComponentProps<typeof TDSResult>;
type FigureTypeLabel = typeof figureTypeLables[number];
type TitleLabel = typeof titleLabels[number];
type DescriptionLabel = typeof descriptionLabels[number];
type ButtonLabel = typeof buttonLabels[number];

interface Props {
  figureType: FigureTypeLabel;
  lottieURL: string;
  iconName: string;
  title: TitleLabel;
  titleText: string;
  description: DescriptionLabel;
  descriptionText: string;
  button: ButtonLabel;
  buttonText: string;
  buttonType: ButtonTypeLabel;
  buttonStyle: ButtonStyleLabel;

  onButtonClick?: () => void;
}

function getFigureComponent({ figureType, lottieURL, iconName }: Pick<Props, 'figureType' | 'lottieURL' | 'iconName'>) {
  switch (figureType) {
    case 'ë¡œë ':
      return <Lottie url={lottieURL} loop={false} />;
    case 'ì•„ì´ì½˜':
      return <TDSIcon name={iconName} />;
    default:
      return;
  }
}

export function Result(props: Props) {
  const {
    figureType,
    lottieURL,
    iconName,
    title,
    titleText,
    description,
    descriptionText,
    button,
    buttonText,
    buttonType,
    buttonStyle,

    onButtonClick,
  } = useFilteringEventHandlersInInspector(props);

  return (
    <TDSComponent
      name="Result"
      summary={{
        icon: figureType === 'ì•„ì´ì½˜' ? iconName : undefined,
        lottie: figureType === 'ë¡œë ' ? lottieURL : undefined,
        title: title === 'ìˆìŒ' ? titleText : undefined,
        description: description === 'ìˆìŒ' ? descriptionText : undefined,
        button:
          button === 'ìˆìŒ'
            ? {
                type: typeByControlLabel[buttonType],
                style: styleByControlLabel[buttonStyle],
                size: 'medium',
                text: buttonText,
              }
            : undefined,
      }}
    >
      <TDSResult
        figure={getFigureComponent({ figureType, lottieURL, iconName })}
        title={title === 'ìˆìŒ' ? titleText : undefined}
        description={description === 'ìˆìŒ' ? descriptionText : undefined}
        button={
          button === 'ìˆìŒ' ? (
            <TDSButton
              type={typeByControlLabel[buttonType]}
              style={styleByControlLabel[buttonStyle]}
              onClick={onButtonClick}
            >
              {buttonText}
            </TDSButton>
          ) : undefined
        }
      />
    </TDSComponent>
  );
}

addPropertyControls(Result, {
  figureType: {
    title: 'ğŸ ìƒë‹¨ ê·¸ë˜í”½',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: figureTypeLables as any,
    defaultValue: 'ë¡œë ',
  },
  lottieURL: {
    title: 'â†³ ë¡œë ì£¼ì†Œ',
    type: ControlType.String,
    defaultValue: 'https://static.toss.im/lotties/spot/spot-empty-alt.json',
    hidden(props) {
      return props.figureType !== 'ë¡œë ';
    },
  },
  iconName: {
    title: 'â†³ ì•„ì´ì½˜ ì´ë¦„',
    type: ControlType.String,
    defaultValue: 'icn-info-line',
    hidden(props) {
      return props.figureType !== 'ì•„ì´ì½˜';
    },
  },
  title: {
    title: 'âœï¸ íƒ€ì´í‹€',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: titleLabels as any,
    defaultValue: 'ìˆìŒ',
  },
  titleText: {
    title: 'â†³ í…ìŠ¤íŠ¸',
    type: ControlType.String,
    displayTextArea: true,
    defaultValue: 'ë‹¤ì‹œ ì ‘ì†í•´ì£¼ì„¸ìš”',
    hidden(props) {
      return props.title === 'ì—†ìŒ';
    },
  },
  description: {
    title: 'âœï¸ ì„¤ëª…',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: descriptionLabels as any,
    defaultValue: 'ìˆìŒ',
  },
  descriptionText: {
    title: 'â†³ í…ìŠ¤íŠ¸',
    type: ControlType.String,
    displayTextArea: true,
    defaultValue: 'í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤\në‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”',
    hidden(props) {
      return props.description === 'ì—†ìŒ';
    },
  },
  button: {
    title: 'ğŸ”µ ë²„íŠ¼',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: buttonLabels as any,
    defaultValue: 'ìˆìŒ',
  },
  buttonText: {
    title: 'â†³ í…ìŠ¤íŠ¸',
    type: ControlType.String,
    defaultValue: 'ì¬ì‹œë„',
    hidden(props) {
      return props.button === 'ì—†ìŒ';
    },
  },
  buttonType: {
    title: 'â†³ ìƒ‰ìƒ',
    type: ControlType.Enum,
    options: buttonTypeLabels as any,
    defaultValue: 'ğŸ”µ ë¸”ë£¨',
    hidden(props) {
      return props.button === 'ì—†ìŒ';
    },
  },
  buttonStyle: {
    title: 'â†³ íƒ€ì…',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: buttonStyleLabels as any,
    defaultValue: 'Fill',
    hidden(props) {
      return props.button === 'ì—†ìŒ';
    },
  },
  onButtonClick: {
    type: ControlType.EventHandler,
  },
});

(Result as any).defaultProps = {
  width: 375,
  height: 400,
};

Result.displayName = makeComponentDisplayName('Result', 'ë¹ˆí™”ë©´');

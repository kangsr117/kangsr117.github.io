import { addPropertyControls, ControlType } from 'framer';
import * as React from 'react';
import {
  default as TDSAmountTop,
  Props as TDSAmountTopProps,
} from '../@tossteam/tds-web/react/components/AmountTop/AmountTop';
import { Style } from '../@tossteam/tds-web/react/components/Button/Button';
import { commaizeNumber } from '../@tossteam/tds-web/react/utils/commaize';
import { TDSComponent } from '../src/components/TDSComponent';
import { useFilteringEventHandlersInInspector } from '../src/hooks/useFilteringEventHandlersInInspector';
import '../src/styles/tds-framer.css';
import { makeComponentDisplayName } from '../src/utils/makeDisplayName';

const rightButtonLables = ['ì—†ìŒ', 'ìˆìŒ'] as const;
const subtitleStyleLables = ['ì¼ë°˜', 'ğŸš§ ë°‘ì¤„'] as const;
const priceInputTypeLabels = ['ìŠ¬ë¼ì´ë”', 'ì§ì ‘ì…ë ¥'] as const;
const rightButtonStyleLables = ['Fill', 'Weak'] as const;

type RightButtonLabel = typeof rightButtonLables[number];
type SubtitleStyleLabel = typeof subtitleStyleLables[number];
type PriceInputTypeLabel = typeof priceInputTypeLabels[number];
type RightButtonStyleLabel = typeof rightButtonStyleLables[number];

const rightButtonStyleByControlLabel: {
  [key in RightButtonStyleLabel]: Style;
} = {
  Fill: 'fill',
  Weak: 'weak',
};

interface Props {
  subtitle: string;
  subtitleStyle: SubtitleStyleLabel;
  priceInputType: PriceInputTypeLabel;
  sliderPrice: number;
  customPrice: string;
  suffix: string;
  rightButton: RightButtonLabel;
  rightButtonText: string;
  rightButtonStyle: RightButtonStyleLabel;

  onSubtitleClick?: () => void;
  onRightButtonClick?: () => void;
}

export function AmountTop(props: Props) {
  const {
    priceInputType,
    sliderPrice,
    customPrice,
    suffix,
    subtitle,
    rightButton,
    rightButtonText,
    rightButtonStyle,
    onSubtitleClick,
    onRightButtonClick,
  } = useFilteringEventHandlersInInspector(props);

  const componentProps: TDSAmountTopProps = {
    title: `${commaizeNumber(priceInputType === 'ìŠ¬ë¼ì´ë”' ? sliderPrice : customPrice)} ${suffix}`,
    subtitle,
    rightButton:
      rightButton === 'ìˆìŒ'
        ? {
            text: rightButtonText,
            style: rightButtonStyleByControlLabel[rightButtonStyle],
            onClick: onRightButtonClick,
          }
        : undefined,
  };

  return (
    <TDSComponent
      name="AmountTop"
      summary={{
        title: componentProps.title,
        subtitle,
        button: componentProps.rightButton,
      }}
    >
      <TDSAmountTop {...componentProps} />
    </TDSComponent>
  );
}

addPropertyControls(AmountTop, {
  subtitle: {
    title: 'âœï¸ ë³´ì¡° í…ìŠ¤íŠ¸',
    type: ControlType.String,
    defaultValue: 'í…ìŠ¤íŠ¸ë¥¼ ì ì–´ì£¼ì„¸ìš”',
  },
  subtitleStyle: {
    title: 'â†³ ì¢…ë¥˜',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: subtitleStyleLables as any,
    defaultValue: 'ì¼ë°˜',
  },
  priceInputType: {
    title: 'ğŸ’° ê¸ˆì•¡',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: priceInputTypeLabels as any,
    defaultValue: priceInputTypeLabels[0],
  },
  sliderPrice: {
    title: 'â†³ ê¸ˆì•¡ ì¡°ì ˆ',
    type: ControlType.Number,
    min: 0,
    max: 3000000,
    defaultValue: 30000,
    hidden(props) {
      return props.priceInputType !== 'ìŠ¬ë¼ì´ë”';
    },
  },
  customPrice: {
    title: 'â†³ ì§ì ‘ ì…ë ¥',
    type: ControlType.String,
    defaultValue: '30000',
    hidden(props) {
      return props.priceInputType !== 'ì§ì ‘ì…ë ¥';
    },
  },
  suffix: {
    title: 'â†³ ë‹¨ìœ„',
    type: ControlType.String,
    defaultValue: 'ì›',
  },
  rightButton: {
    title: 'â¡ï¸ ìš°ì¸¡ ë²„íŠ¼',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: rightButtonLables as any,
    defaultValue: 'ìˆìŒ',
  },
  rightButtonText: {
    title: 'â†³ í…ìŠ¤íŠ¸',
    type: ControlType.String,
    defaultValue: 'ì†¡ê¸ˆ',
    hidden(props) {
      return props.rightButton === 'ì—†ìŒ';
    },
  },
  rightButtonStyle: {
    title: 'â†³ ì¢…ë¥˜',
    type: ControlType.Enum,
    displaySegmentedControl: true,
    options: rightButtonStyleLables as any,
    defaultValue: 'ìˆìŒ',
    hidden(props) {
      return props.rightButton === 'ì—†ìŒ';
    },
  },
  onSubtitleClick: {
    type: ControlType.EventHandler,
  },
  onRightButtonClick: {
    type: ControlType.EventHandler,
  },
});

(AmountTop as any).defaultProps = {
  width: 375,
  height: 174,
};

AmountTop.displayName = makeComponentDisplayName('AmountTop', 'ì–´ë§ˆìš´íŠ¸íƒ‘');

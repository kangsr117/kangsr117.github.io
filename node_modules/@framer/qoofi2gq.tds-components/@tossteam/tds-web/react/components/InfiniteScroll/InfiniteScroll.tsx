import classNames from "classnames";
import * as React from "react";
import { forwardRef, ReactNode } from "react";
import useInfiniteScrollHandler, {
  ScrollDirection,
} from "./hooks/useInfiniteScrollHandler";

export interface Props {
  /**
   * 이벤트를 감지할 수 있는 하단까지의 스크롤 거리 입니다. 값이 0보다 크면 스크롤끝에서 값만큼 전에 스크롤이 감지됩니다.
   * 단위는 px 입니다.
   * @default 0
   */
  threshold?: number;
  onScroll: (direction: ScrollDirection) => void;
  children: ReactNode;
  className?: string;
}

/**
 * 컴포넌트의 하단까지 스크롤 시에 이벤트를 발생시키는 컴포넌트입니다.
 */
const InfiniteScroll = forwardRef<HTMLDivElement, Props>(
  ({ threshold = 0, onScroll, children, className }, ref) => {
    const handleScroll = useInfiniteScrollHandler({ threshold, onScroll });

    return (
      <div
        ref={ref}
        onScroll={handleScroll}
        className={classNames("infinite-scroll-container", className)}
      >
        {children}
      </div>
    );
  }
);

export default InfiniteScroll;

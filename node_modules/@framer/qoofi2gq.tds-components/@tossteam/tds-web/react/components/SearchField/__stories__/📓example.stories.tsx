import { action } from "@storybook/addon-actions";
import { storiesOf } from "@storybook/react";
import * as React from "react";
import { useState } from "react";
import { Button, FixedBottomCTA, ListRow, SearchField } from "src/react";
import Readme from "../README.md";

const simpleArray = [...Array(15).keys()].map((el) => `ListRow ${el}`);

storiesOf("SearchField", module)
  .addParameters({ readme: { sidebar: Readme } })
  .add("📓example - fixed to top", () => {
    const [list, setList] = useState(simpleArray);
    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
      action("텍스트 업데이트")(e);
      const value = e.target.value;
      setList(value ? list.filter((el) => el.includes(value)) : simpleArray);
    };

    return (
      <div>
        <SearchField
          placeholder="리스트 검색"
          onChange={handleChange}
          onDeleteClick={action("삭제 아이콘 클릭")}
          takeSpace
          fixed
        />
        {list.map((el, idx) => (
          <ListRow key={idx} contents={el} />
        ))}
        <FixedBottomCTA type="primary">CTA</FixedBottomCTA>
      </div>
    );
  })
  .add("📓example - value 직접 제어", () => {
    const INITIAL_VALUE = "3";
    const [myValue, setMyValue] = useState(INITIAL_VALUE);
    const filteredList = myValue
      ? simpleArray.filter((el) => el.includes(myValue))
      : simpleArray;

    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
      action("텍스트 업데이트")(e);
      setMyValue(e.target.value);
    };

    return (
      <div>
        <SearchField
          placeholder="리스트 검색"
          onChange={handleChange}
          value={myValue}
          onDeleteClick={action("삭제 아이콘 클릭")}
          takeSpace
          fixed
        />
        <Button onClick={() => setMyValue("10")}>10 검색</Button>
        {filteredList.map((el, idx) => (
          <ListRow key={idx} contents={el} />
        ))}
        <FixedBottomCTA type="primary">CTA</FixedBottomCTA>
      </div>
    );
  });

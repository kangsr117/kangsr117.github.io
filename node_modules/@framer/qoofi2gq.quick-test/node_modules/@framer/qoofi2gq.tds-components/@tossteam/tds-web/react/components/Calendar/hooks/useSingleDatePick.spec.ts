import { act, renderHook } from '@testing-library/react-hooks';

import cloneDate from '../../../utils/cloneDate';
import useSingleDatePick from './useSingleDatePick';

describe('Calendar.hooks.useSingleDatePick', () => {
  test('이미 선택된 날짜를 한번 더 선택하면 선택 날짜를 없앤다.', () => {
    const selectedDate = new Date(2019, 5, 4);
    const onDateChange = jest.fn();

    const { result } = renderHook(() => useSingleDatePick(selectedDate, onDateChange));

    act(() => {
      const [, handleDayClick] = result.current;
      handleDayClick(cloneDate(selectedDate));
    });

    expect(onDateChange).toHaveBeenCalledWith(undefined);
  });

  test('날짜를 선택하면 해당 날짜로 변경한다.', () => {
    const onDateChange = jest.fn();
    const { result } = renderHook(() => useSingleDatePick(undefined, onDateChange));

    const selectedDate = new Date(2019, 5, 4);

    act(() => {
      const [, handleDayClick] = result.current;
      handleDayClick(cloneDate(selectedDate));
    });

    expect(onDateChange).toHaveBeenCalledWith(selectedDate);
  });
});
